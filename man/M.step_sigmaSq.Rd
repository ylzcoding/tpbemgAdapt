% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Mstep.R
\name{M.step_sigmaSq}
\alias{M.step_sigmaSq}
\title{M-step for sigmaSq using a numerically stable and memory-efficient approach.}
\usage{
M.step_sigmaSq(beta_matrix, X, y, n, diagX = FALSE)
}
\arguments{
\item{beta_matrix}{S*p matrix of posterior beta samples from the E-step.}

\item{X, }{y, n The data and its dimensions.}

\item{diagX}{Logical, if TRUE, assumes X is a diagonal matrix.}
}
\value{
A single, non-negative numeric value for the updated sigmaSq.
}
\description{
This version directly computes the expectation of the Sum of Squared Residuals,
which avoids catastrophic cancellation and guarantees a non-negative result without
creating large p*p matrices.
}
